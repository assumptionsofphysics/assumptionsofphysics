\documentclass[10pt,twocolumn, nofootinbib]{revtex4-2}
%\documentclass[aps,pra,10pt,twocolumn,floatfix,nofootinbib]{revtex4-1}
%\documentclass[10pt,twocolumn,letterpaper]{article}

\usepackage{assumptionsofphysics}

%\usepackage{amsmath}
%\usepackage{mathrsfs}
%\usepackage{amsfonts}
%
%\usepackage{graphicx}
%\usepackage{hyperref}
%\hypersetup{
%	colorlinks=true,
%	citecolor=blue,
%	urlcolor=blue,
%	linkcolor=blue
%}
%\urlstyle{same}
%\frenchspacing
%
\def\>{\rangle}
\def\<{\langle}
\DeclareMathOperator{\erf}{erf}

\begin{document}

\title{The unphysicality of Hilbert spaces}
\author{TBD}
\affiliation{Physics Department, University of Michigan, Ann Arbor, MI 48109}

\date{\today}


\begin{abstract}
TBD
\end{abstract}

\maketitle

\section{Introduction}

Hilbert spaces have been the cornerstone of quantum mechanics since von Neumann (\cite{von_neumann_mathematische_1996}). Their use made available a vast number of theorems (Gleason, Riesz, Wigner, Stone, etc.) that made up the mathematical backbone of the theory and also represented a role model of mathematical rigor that people working on quantum field theory would try to achieve decades later \cite{haag_discussion_2010}. Wightman even took von Neumann's book to be the fulfillment of a project Hilbert himself kicked off with his problems on the foundations of mathematics (\cite[p. 157]{browder_hilberts_1976}): to axiomatize the physical sciences. But, despite the undeniable importance of wanting to set physics on a firm mathematical footing, we must remember that by ``axioms,'' they meant ``physically motivated constraints'' more than statements that can be immune to question, rethink, and, if necessary, revise.\footnote{For a more extended discussion of von Neumann's axiomatics and their physical inputs, see \cite{redei_soft_2006}.}

Now, there are well-known shortcomings of Hilbert spaces, but they are deemed unproblematic: states are rays, not vectors; the Dirac delta is a distribution, not a function; and some elements from $L^2(\mathbb{R})$ don't seem apt candidates to be wave functions. Given the importance Hilbert spaces have had and the issues we have let slide, it's not a surprise that they have become fossilized as parts of axiomatic systems\footnote{Even axiomatic formulations of quantum field theory (see e. g. \cite{haag_local_1996}) that don't need to use Hilbert spaces to make meaningful claims about quantum-mechanical observables and states can reassure physicists unfamiliar with this approach by recovering the Hilbert spaces they know and love through the GNS construction.} without even considering whether we can do quantum mechanics with weaker assumptions. So, despite all their success, perhaps it's time to ask if using Hilbert spaces to describe quantum states, an assumption whose physical motivation was meant to be revised as time passed, has become a dogma.

\section{On the physicality of Hilbert spaces}

Let us first clarify the standard we believe should be usde to judge the physicality of a formal definition. Suppose we have a physical system under study in a given condition. We say a mathematical definition is \textbf{physical} if it is the proper mathematical characterization of the physical system. That is, if it can be shown that the mathematical definition is needed to capture and only capture a particular aspect of the physical system. On the other hand, a mathematical definition is \textbf{unphysical} if it can be shown to require physical properties or operations that cannot be implemented physically.

For example, suppose we have a set of physically distinguishable objects, meaning that we can tell any two apart through an experimental test. Experimentally, the best we can do is collect finite information in finite time. If we are given an arbitrarily long time, we can collect an arbitrary amount of finite information. An element of the set, then, must be identified by at most a countably infinite sequence of ones and zeros, so that, at some point, we would be able to tell the difference between the two sequences and therefore the objects. The set of countable sequences of zeros and one can be understood as the binary expansion of real numbers between zero and one, which has cardinality of the continuum. Therefore, any definition that would require a set of physical objects to have cardinality greater than the continuum, then, is \textbf{unphysical}. For example, non separable Hilbert spaces have cardinality greater than the continuum, and therefore should be considered unphysical.

Naturally, this does not mean that all sets with cardinality of the continuum or lower are physical. In general, testing physicality is harder as we need to check that all the mathematical features map to physical feature and no physical feature is left behind. Clearly, postulating that ``the state space of a quantum states has cardinality no grater than that of the continuum'' is certainly \textbf{physical} but, however, this tells us little. Let us then see what elements of Hilbert spaces should we consider physical in the context of quantum mechanics.

\subsection{Inner vector space}

Recall that a Hilbert space is a complete inner product space. That is, it is a vector product, with an inner product, closed under Cauchy sequences. We will look at the first two structures briefly, leaving all detail to the appendix, as their physical significance is not surprising.

Roughly speaking, a vector space is a set whose elements can be combined linearly: can be multiplied by constants and summed. If one regards superpositions as physical requirements of quantum theory, one may think that this structure is physical. However, the ability to interpret linear combination as superpositions requires the ability to keep track of orthonormal vectors. If we can only know whether two vectors are in the same ray, we are not able to recover the idea of a probability amplitude, as those are the coefficients of a linear combination between normalized and orthogonal states that return another normalized state. Therefore the vector space structure, by itself, is not physical.

If we add the inner product, we can define norm and orthogonality and therefore we can indeed express superpositions. Additionally, the inner product structure also defines the Born rule, the transition probability during measurement. If one is comfortable in considering superpositions and the Born rule to be physical requirements of quantum mechanics, then the inner product structure is \textbf{physical}. However, some may not consider superpositions as actual physical objects, but more as mathematical constructs; others may object that the Born rule, in its standard interpretation, defines probability of transitions while a state space should be defined at equal time; others can argue that the states are defined by the rays, and therefore the requirements should only be in terms of those objects. For those and other reasons, we have an alternative, more necessary justification, which we include in the appendix, and can be summarized as follows.

Given that, experimentally, no preparation or measurement is perfect, a physical theory must define the space of statistical ensembles. Mathematically, these form a convex set, that physically represents a set that allows statistical mixtures. The geometry of the space of statistical ensembles is uniquely defined by the inner product and vector space structures, which means properties of the inner product space can be reexpressed as properties of the space of mixtues.\footnote{There is a rich literature on Generalized Probability Theory in which people reconstruct Quantum Theory by imposing requirements on convex spaces.} For example, we can characterize superposition in the following way: a pure state $\psi$ is expressible as a superposition of other pure states $\{\phi_i\}$ if and only if there is a mixed state $\rho$ that can be equivalently expressed as a mixture of $\{\phi_i\}$ or as a mixture of $\psi$ and other pure states. That is, the ability to create superposition is conceptually equivalent to the ability to prepare the same mixture in different ways, another feature particular to quantum mechanics. Additionally, the inner product can be shown to be equivalent to determining the entropy of all equal mixtures of state pairs. These requirements are necessary in the sense that both classical and quantum mechanics need to keep track how ensemble combine under mixing and what entropy each ensemble have.

If we require, then, that the theory reproduces the properties of quantum mixtures, how they can be decomposed in terms of pure states and what their entropy is, the complex inner product space is recovered as a structure that recovers the correct properties. As we said, a physical theory must tell us how to properly characterized statistical mixture, therefore the requirement is necessitated by the physics. \textbf{The inner product space structure is physical}.

\subsection{Completeness}

Completeness of a Hilbert space tells us that the space includes the limit of every Cauchy sequence. This property is more difficult to characterize physically. We can look at an equivalent characterization:\footnote{Roman 2008, p. 330 Theorem 13.8
	
	Roman, Stephen (2008), Advanced Linear Algebra, Graduate Texts in Mathematics (Third ed.), Springer, ISBN 978-0-387-72828-5} the space is complete if, given a series of vectors
$$ \sum _{k=0}^{\infty }u_{k}$$
such that
$$ \sum _{k=0}^{\infty }\|u_{k}\|<\infty \,$$
the series converges in the space. This is now in terms of linear combinations, and therefore it is essentially telling us that we can perform a linear superposition if the sum of the norm of the coefficient converge. We are basically extending superposition to infinite sums. Is this a physical requirement of just mathematical convenience?

As we saw before, superposition experimentally means splitting the state along multiple paths. The above mathematical expression means splitting the original state into infinitely many progressively small component, and be able to place them where we please. It also assumes, for example, that we can place them over an infinite spatial range. Since the limit must be in the space, we are literally saying that we can prepare states that are spread over infinite regions. This does not sound physical.

Again, given the difficulties of understanding superposition, let us reframe the result in terms of statistical quantities. Suppose that we are able to prepare pure states with arbitrary finite expectation value for position. Then completeness means we are also able to prepare pure states that falls off at infinity as $\frac{1}{x^2}$. The expectation value of $x$ would the integral of a function that falls off as $\frac{1}{x}$ which diverges. Clearly, this does not make physical sense. When we posit that a quantity, like position, has an infinite range of possible values, we simply mean that observed value can be arbitrarily large, not that we can literally spread values over an infinite range. 

The argument, then, goes like this. On physical grounds, given a quantity that can take arbitrarily large values, like position, for each possible value there must exist some state whose expectation matches that value. On mathematical grounds, we require completeness, which forces us to posit states with infinite expectation value. But this, on physical grounds, is not teneable. Therefore \textbf{completeness in unphysical.}

\subsection{Impact of unphysicality}

We are forced to conclude that Hilbert spaces have unphysical requirements when applied to quantum mechanics. We clearly see that the issue is the closure of operation over infinite sequences, which is not surprising.\footnote{Large branches of mathematics were developed to handle infinities, both large and small. Weyl stated ``Mathematics is the science of the infinite, its goal the symbolic comprehension of the infinite with human, that is finite, means.'' Hermann Weyl, "The Open World: Three Lectures on the Metaphysical Implications of Science," (1932) as quoted in Mind and Nature: Selected Writings on Philosophy, Mathematics, and Physics (2009) ed. Peter Pesic.} Now we have to understand how big of a problem it is.

On physical grounds, the state space of quantum system is the projective space of a complex inner product space. If the space is finite dimensional, the space is automatically complete.\footnote{This is exactly why, mathematically, completeness is nice as it makes infinite dimensional space behave like finite dimensional ones.} If not, we can always complete it by enlarging the space. In general, then, it is true that a quantum state is a ray of a Hilbert space, but the converse is not true: not all rays of the same Hilbert space will be valid quantum states.

This may not seem like a problem: we simply have a bigger set of object of what we strictly need. Unfortunately, in mathematics working on a bigger space is not always a good thing. For example, take the problem of defining volumes in three dimensional euclidean space $\mathbb{R}^3$. Formally, we want to find a measure $\mu(U)$ that returns the size of the region $U$. Naively, we may want to define it on the set of all possible subsets. In this case, Banachâ€“Tarski paradox tells us that we can take a unit ball, cut it into five pieces, and reassemble those pieces into two balls of the same size. Clearly, this is a problem. However, if we restrict ourselves with a measure on the Borel sets instead of all sets, we get a consistent definition. Therefore, in mathematics, bigger is not always better.\footnote{In another work, we show that the Borel sets are exactly those sets that can be associated with experimental procedures. In many cases, we have found that physical requirements naturally map to well behaved spaces.}

The above example is just a cautionary tale and it doesn't tell us what happens in this specific case. Therefore, let us give an example of the things that can go wrong. Unitary transformation play an important role in the theory of Hilbert spaces for at least two reasons. The first is that two Hilbert spaces that differ by a unitary transformation are mathematically equivalent. A change of representation, like a change of basis, is a unitary transformation. The second reason is that time evolution for an isolated system is represented by a unitary transformation. Let us see, then, the interplay between unitary transformations and our previous findings.

In a Hilbert space, we can always find a unitary transformation that maps one vector to any other. Therefore, there will be unitary transformations that map states with finite expectation values to infinite ones. This means that whether something has a finite expectation value or not will depend on the choice of representation. As a concrete example, consider the following two wave functions
\begin{align}
	\psi(x) &= \sqrt{\frac{e^{-x^2}}{\sqrt{\pi}}} \\
	\phi(x) &= \frac{1}{\sqrt{\pi(x^2 + 1)}}.
\end{align}
Both states are symmetric, and therefore will have zero expectation value for $x$. The first distribution is a Gaussian, and therefore all moments of the distribution, the expectation for $x^n$, are finite. The second goes to infinity like $\frac{1}{x^2}$, so the expectation will diverge for all. We can now find a change of variable $y(x)$ that transforms one distribution into the other. We need to set
\begin{equation}
	\begin{aligned}
	\int_{0}^{x} \psi^\dagger(x) \psi(x) dx &= \int_{0}^{y(x)} \phi^\dagger(x) \phi(x) dx \\
	\int_{0}^{x} \frac{e^{-x^2}}{\sqrt{\pi}} dx &= \int_{0}^{y(x)} \frac{1}{\pi(y^2 + 1)} dx \\
	\frac{\erf(x)}{2} &= \frac{\tan^{-1}(y)}{\pi} \\
	y &= \tan \left(\frac{\pi}{2}\erf(x)\right). \\
	\end{aligned}
\end{equation}
Therefore, thorough a variable change, we can change a state that has finite expectation value for all moments greater than the first into a state that has infinite expectation value for the same moments. Variable changes, in terms of the Hilbert space, are unitary transformation. Therefore the theory of Hilbert spaces, as applied to quantum mechanics, would tell us that the two representations are equivalent.

Experimentally, these are not equivalent. Identifying a state through expectation value is a common technique, called quantum tomography. If a unitary transformation can change finite expectations to infinite ones, we are effectively changing what can be distinguished through a tomography. Not only we cannot measure infinite values, but different finite values would get lumped into the same infinite value. In the above example, if we increase the variance, all even moments would change, yet, after the transformation, they would all be infinite. Therefore the idea that such unitary transformation links to physically equivalent representations is, on physics ground, untenable.

Moreover, we can create the following family of transformations
\begin{equation}
	y = \cos(\omega t) x + \sin(\omega t) \tan \left(\frac{\pi}{2}\erf(x)\right).
\end{equation}
This is clearly continuous in $t$ and, for $t=0$, we have the identity transformation and therefore, mathematically, there is no reason why this wouldn't be a valid time evolution. The effect is simply a stretching back and forth the wavefunctions, such that the state keeps oscillating between the above two functions. On physics grounds, however, we are going from finite to infinite expectations in finite time. This, again, is physically untenable.

We hope that this gives an idea of the type of issues embedded in the mathematical definitions. When performing actual calculations, we do not see these issues because the physics that we are describing makes us work in a corner of the structure where things are reasonable. But when one tries to prove theorems or general results on quantum theory, one currently is forced to consider the entire Hilbert space. It is not inconceivable to expect that results that would be reasonable physically fail to valid when enlarging the space of possible states to those that have infinite expectation values and the space of physical transformations to those that map finite to infinite expectations. We therefore wonder whether some of the issues we have in quantum field theory (e.g. the inability to find a valid measure for path integrals, inequivalent representation of interacting theories (?), infinities) are simply a consequence of the use, at a fundamental level, of unphysical objects.

\section{On the physicality of Schwartz spaces}

Suppose the reader agrees with our finding, the subsequent question is: what is the alternative? If we are only interested in observable with finitely many possible outcomes, we can use finite dimensional spaces. But as soon we have discrete quantities with arbitrarily large values, such as the number of particles, or quantities that are continuous, like position and momentum, we need infinite dimensional spaces. If we allow infinite dimensional spaces, we need some way of controlling what infinite linear combinations are allowed or not allowed. Cauchy completeness is one such way, but if that is not physical, what should we use?

We saw that the main problem is having expectation values that diverge, therefore the naive idea would be to require that the expectation value for all possible variables converge. This would require the expectation for $e^x$, $e^{e^x}$, $e^{e^{e^x}}$ and so on to be finite as well, which seems rather extreme. But what is a reasonable point to stop? If the idea is that we need to be able to reconstruct the state from expectation values, we should note that bounded distributions can be recovered from all the moments of the distribution, from the expectation of $x^n$ for every finite $n$. It seems reasonable, then, to require the expectation of all polynomial of position and momentum to be finite.

In quantum mechanics, this means requiring all expectations of $X^nP^m = -\imath \hbar x^n\partial_x ^m$ to be finite. This restricts our space to those functions that are infinitely smooth (i.e. all derivative exist) and decrease very rapidly as $x$ goes to infinity: the Schwartz functions. Requiring finite expectation for all polynomials of position and momentum, then, does not give us the usual $L^2$ Hilbert space, it gives us the Schwartz space. Is this a better candidate?

First of all, the Schwartz space is a subspace of the $L^2$ Hilbert space taken as an inner product space. That is, all Schwartz functions are elements of the Hilbert space, they are closed under linear combinations and have the same inner product. It is not, however, complete, which is what we want. Moreover, it is a dense subspace, meaning that any element of the Hilbert space can always be approximated by a Schwartz function with an arbitrary level of precision. Or, equivalently, that once a map is defined over the Schwartz space, the map is uniquely extended over the Hilbert space. This is a good hint that we have thrown away only unphysical elements.

If we restrict ourselves to the Schwartz space, then, the only unitary transformations we are interested in are those that map Schwartz function to Schwartz functions. The change of coordinate we defined in the previous section, then, is ruled out. Limits in terms of Cauchy sequences are not guaranteed, but limits in terms of expectation values are guaranteed: if we have a sequence of states such that the limit of the expectation converge, then we are guaranteed that the limit is also a Schwartz function.

The Schwartz space has also a very important property: it is the only space that is closed under the Fourier transform. That is, the Fourier transform of a Schwartz function is a Schwartz function, and it is the only set of functions with this property. This is not, in retrospect, a nice property that would be convenient for physicists. The theory of tempered distribution, which allows us to define the Dirac $\delta$-function, is mathematically based, at its core, over the Schwartz space. Therefore, this space already plays a fundamental role in the definitions of the tools we already use.

On the downside, many of the tools we use indeed assume a Hilbert space and many theorems would not hold without Cauchy completeness. There are two responses to this issue. First of all, there is no reason to prohibit that calculation are performed on the larger, unphysical space. When solving an integral, we do sometimes extend the domain for real to complex values, which are unphysical, because complex analysis has nicer mathematical features. The result so found, however, is still the valid result on the real domain. Similarly, we can pose the problem on the Schwartz space, extend to the Hilbert space for calculation, and then bring the result back to the Schwart space. However, there is a second way to look at this issue. Given that the focus has been squarely on Hilbert spaces, we do not know which mathematical results will hold, or even whether other results may be found. This is not something that the authors of this paper can answer and neither the mathematicians that were asked. This requires a serious research effort on the mathematical underpinning of multiple areas, which brings us to our closing point.

This effort is never going to happen if the physics community, as whole, do not generate enough interest on the subject. There may be a better series of mathematical tools and results that stem from a more precise specification of our physical requirements in terms of mathematical definitions. It is unlikely that the mathematical world will give us these tools unprompted. It is the job of us physicists to understand exactly what are ramifications of the definitions in terms of what physical objects would be left out or what unphysical objects would be brought in.

\section{Conclusion}

% TODO: hint that the unitary transformations on Schwartz space are a subset of the ones on the Hilbert, and therefore they have unique inverse; operators we are interested in are uniquely extended to the Hilbert space.


\bibliography{bibliography}

\newcommand{\pj}[1] {\underbar{$#1$}}

\section*{Appendix}

We give the full mathematical detail in support of the argument laid out in the main paper




A vector space is a set where the elements can be summed and multiplied by a constant. In quantum mechanics, the set represents pure states and the linear combination represent superposition of states. One may already accept this as physical, as superpositions can be created in a lab when, for example, a particle goes through a beam splitter. However, there are two difficulties.

First of all, it is not clear whether superpositions are actual physical entities or whether they are just mathematical constructs. This is an area where different interpretations may differ, and we do not want our physical justification to depend on our interpretation. We want to decide whether the mathematical representation is physical regardless of the interpretation. Second, the actual states are not represented by vectors, but by rays. The superposition, then, is in terms of objects that are not themselves strictly physical. For these two reasons, we want to find another way an equivalent characterization of the linearity of the space that is fully physical.

Let us consider the space of density operators, which can be used to characterize both pure and mixed state. These objects are invariant under change of phase and are in one-to-one correspondence with the rays of the space, not with the vectors. The density operators have a linear structure that represent statistical mixtures. This is a necessary structure because preparing statistical mixtures is something we can always do physically, and therefore something a physically meaningful mathematical definition must provide. However, the linear structure of density operators is not the same as the linear structure of the Hilbert space.

When we write
$$c_1|\psi_1\> + c_2 |\psi_2\>$$
and 
$$p_1|\psi_1\>\<\psi_1| + p_2|\psi_2\>\<\psi_2|$$
the meaning of the $+$ symbols is different. The first operations is a complex linear combination of two pure states that returns another pure state, while the second is a real linear combination of two pure states that returns a mixed state. However, the two are so intertwined that one can be recovered by the other.

As we show in the appendix, a pure state $\psi$ is a superposition of two other pure states $\phi_1$ and $\phi_2$ if and only if there exists another pure states $\bar{\psi}$ such that we can mix $\psi$ and $\bar{\psi}$ to obtain a mixed state that can also be obtained by mixing $\phi_1$ and $\phi_2$. Geometrically, consider a Bloch sphere. If $\psi$ is a superposition of $\phi_1$ and $\phi_2$ then all three states are on the surface of the same sphere. The chord connecting $\phi_1$ and $\phi_2$ represents the space of all possible mixtures of $\phi_1$ and $\phi_2$. Now, take a point $\rho$ on that chord, and consider the line that passes through $\rho$ and $\psi$. The same line will traverse the sphere at another point, which we call $\bar{\psi}$. Since $\rho$ is on the chord that connects $\psi$ and  $\bar{\psi}$, it is a mixture of the two. Therefore the vector space structure can be recovered by knowing how pure state mix.

Note that the fact that the same statistical mixture can be decomposes in multiple ways is a characteristic feature of quantum mechanics, that is not present in classical mechanics. Using the same characterization, then, we consistently conclude that in classical mechanics there are no superpositions precisely because, given a pure state $\psi$, we can never find a corresponding state $\bar{\psi}$.

The argument, then, goes like this. On physical grounds, we must be able to construct mixture. On physical grounds, we must be able to tell whether the same mixture can be prepared in different ways. The vector space structure captures exactly which pairs of pure states produce indistinguishable mixtures. The vector space structure exactly captures that structure and therefore it is fully physically justified. \textbf{The vector space structure is physical.}

\subsection{Inner product}

The inner product defines a geometrical structure on top of the vector space. Namely, it gives an idea of size of each vector and of angle between vectors. In quantum mechanics, the square of the inner product
\begin{equation}
	p(\psi_1, \psi_2) = |\<\psi_1| \psi_2\>|^2.
\end{equation}
represent the probability of measuring one state having prepared another. One may already accept this as physical, as these probabilities define all observable features of quantum mechanics. There is, again, a difficulty.

Understanding the inner product as giving the probability of measurements also brings in one of the most controversial aspects of the theory: measurements. This is, again, a problem since we want our reasoning to be independent of interpretation. Another issue is that, technically, the inner product is linked to decomposition in linear combinations, to superposition, which are done at equal time. The probability above, instead, is a probability of transition.

Given that we have characterized superposition in terms of mixtures, we should see whether the inner product characterizes something fundamental about them, and indeed it does. Given two pure states, the entropy of the mixture is a strictly monotonic, and therefore invertible, function of the square of the inner product. The greatest entropy is given by mixing orthogonal states, which gradually decreases as the angle in the inner product space decreases. We can then understand the geometrical structure of the pure quantum states as an entropic structure, much like it happens for classical mechanics.\footnote{In classical mechanics, the Liouville measure returns the count of states within a region, which is used in the fundamental postulate of statistical mechanics. The symplectic form gives us the Liouville measure for each independent degree of freedom.}

The argument, then, goes like this. On physical grounds, for each statistical mixture, the thermodynamic entropy must be defined. Therefore it must be defined for equal mixtures of two pure states as well. The inner product exactly captures how that quantity combines and therefore it is fully physically justified. \textbf{The inner product structure is physical.}


\subsection{Physicality of inner product space structure}

First we want to show that the vector space structure is not, by itself, physical. Since quantum states are represented by rays of a Hilbert space, and since rays can be defined simply on top of the vector space structure alone, one may think that the vector space structure, by itself, is physical. The issue is that, without an inner product, one cannot make physical sense of the coefficients one uses for linear combinations, therefore superpositions becomes ill-defined.

The following proposition tells us that there are infinitely many ways to decompose a vector representing a state in terms of vectors that represent two other states.
\begin{prop}\label{vector_insufficient}[The vector space structure is not enough to uniquely identify superpositions.] Let $\mathcal{H}$ be a complex vector space and let $\textbf{P}(\mathcal{H})$ be its projective space. Let $\psi, \phi_1, \phi_2 \in \mathcal{H}$ such that $\psi = c_1 \phi_1 + c_2 \phi_2$ for some $c_1, c_2 \in \mathbb{C}$. Let $\pj{\psi}, \pj{\phi_1}, \pj{\phi_2} \in \textbf{P}(\mathcal{H})$ be the corresponding rays in the projective space. Then for any $\hat{c}_1, \hat{c}_2 \in \mathbb{C}$ we can find $\hat{\phi}_1 \in \pj{\phi_1}$ and $\hat{\phi}_2 \in \pj{\phi_2}$ such that
$$\psi = \hat{c}_1 \hat{\phi}_1 + \hat{c}_2 \hat{\phi}_2.$$
\end{prop}

\begin{proof}
Let $\hat{\phi}_1 = \frac{c_1}{\hat{c}_1} \phi_1$. Since they differ only by a constant, they are elements of the same ray. That is, $\hat{\phi}_1 \in \pj{\phi_1}$. Similarly, we let $\hat{\phi}_2 = \frac{c_2}{\hat{c}_2} \phi_2$ and we have $\hat{\phi}_2 \in \pj{\phi_2}$. We have
\begin{equation}
\begin{aligned}
	\hat{c}_1 \hat{\phi}_1 + \hat{c}_2 \hat{\phi}_2 &= \frac{c_1}{\hat{c}_1} \phi_1 + \frac{c_2}{\hat{c}_2} \phi_2 \\
	&= c_1 \phi_1 + c_2 \phi_2 \\ 
	&= \psi.
	\end{aligned}
\end{equation}
This concludes the proof.
\end{proof}

The intuition that a state has a single linear decomposition in terms of other vectors requires, first of all, that the vectors are normalized. To identify the coefficient as probability amplitudes, that is that $\sum_i |c_i|^2 = 1$, further requires the decomposition to be done on orthogonal vectors.\footnote{TODO: mention Gram-Schmidt orthonormalization} That is, linear combinations require the inner product to be understood physically as superpositions. The vector space structure by itself is therefore insufficient to provide a clear connection to physics.

We could now use the above reasoning to argue that the inner product space structure, as a whole, is physical, because it indeed characterizes both superpositions and the Born rule. These are features required by quantum mechanics, and therefore necessary and physically motivated. Many will find this argument convincing enough, however there a couple of objective problems.

First of all, it is not clear whether superpositions are actual physical entities or whether they are just mathematical constructs. This is an area where different interpretations may differ,\footnote{TODO: add citations} some arguing that they are just mathematical representations, and the physicality of a mathematical representation should not be interpretation dependent. Second, the Born rule, in its standard characterization, brings in one of the most controversial aspects of the theory, measurements, which suffers from an interpretation problem as well. Lastly, the inner product is critical for both the Born rule, which is a transition probability of transition before and after the measurement, and linear decomposition into superposition, which is done at equal time. The goal, then, is to find a characterization of our physical requirement that is interpretation independent, more cohesive and perhaps more physically necessary.

The idea is to reformulate the requirements that lead to superposition and the Born rules in terms of equivalent requirements of statistical mixtures. Mathematically, these will be in terms of the space of density operators in stead of the vector space itself.\footnote{Similar efforts can be found in the literature of Quantum Logic and of Generalized Probability Theories. TODO: add citations}.

The idea is to link superposition to another feature of quantum mechanics: the non-unique decomposition of mixed state into pure states. For example, if we take the maximally mixed state for a spin 1/2 system, this can be implemented with an equal mixture of spin up and spin down, or with an equal mixture of spin left and spin right. The idea is that a pure state $\psi$ is expressible as a superposition of other pure states $\{\phi_i\}$ exactly if there is a mixed state $\rho$ that can be equivalently expressed as a mixture of $\{\phi_i\}$ or as a mixture of $\psi$ and other pure states. To keep the reasoning as general as possible, we will not require $\{\phi_i\}$ to be orthogonal to each other.

\begin{prop}\label{prop_densitySpan}
	Let $\mathcal{H}$ be a complex inner product space. Let $\{\psi_i\}, \{\phi_j\} \in \mathcal{H}$ be two finite sets of normalized vectors. Suppose there exists a density operator that can be expressed as a strict convex combination of either set, that is we can find two sequences $\{a_i\}, \{b_j\} \in \mathbb{R}^+$ such that
	\begin{enumerate}
		\item $\sum_i a_i = 1$
		\item $\sum_j b_j = 1$
		\item $\sum_i a_i |\psi_i\>\<\psi_i| = \sum_j b_j |\phi_j\>\<\phi_j|$,
	\end{enumerate}
	then the span of the two sets is the same.
\end{prop}

\begin{proof}
	Consider $\rho = \sum_i a_i |\psi_i\>\<\psi_i|$. For a unitary vector $\varphi \in \mathcal{H}$ we have
	$$p(\varphi|\rho)=tr(\rho |\varphi\>\<\varphi|) =  \sum_i a_i |\<\psi_i|\varphi\>|^2$$
	Since all $a_i$ are positive, $p(\varphi|\rho) = 0$ if and only if $\varphi$ is orthogonal to all $\psi_i$.
	
	Now suppose $\rho = \sum_i a_i |\psi_i\>\<\psi_i| = \sum_j b_j |\phi_j\>\<\phi_j|$. Then a vector $\varphi$ is orthogonal to all $\psi_i$ if and only if it is also orthogonal to all $\phi_i$, which means $span(\{\psi_i\}) = span(\{\phi_j\})$) as they have the same orthogonal complement.
\end{proof}

\begin{prop}\label{prop_decomposition}
	Let $\mathcal{H}$ be a complex inner product space. Let $\psi \in \mathcal{H}$ be a normalized state and $\rho : \mathcal{H} \to \mathcal{H}$ a density operator of finite rank such that $\<\psi|\rho|\psi\>\neq 0$. Then we can express $\rho$ as a mixture of $\psi$. That is, there exists a finite set of normalized states $\{\psi_i\} \in \mathcal{H}$ such that $\psi_1 = \psi$ and $\rho = \sum_i p_i |\psi_i\>\<\psi_i|$.
\end{prop}

\begin{proof}
	The set of all possible density operators is a convex set, which can be understood as a subset of a vector space $V$. Let $\rho$ be a density operator such that $\<\psi|\rho|\psi\>\neq 0$. If $\rho = |\psi\>\<\psi|$, we are done. If not, the two elements will identify a line, which must intersect the boundary of the convex set in two places. One must be $\psi$, since $\psi$ is a pure state and therefore an extreme point. Let $\rho_1$ be the other point. If it is an extreme point, we are done as $\rho$ is an affine combination of $\psi$ and $\rho_1$. If not, the boundary of the convex set in a neighborhood of $rho_1$ is not strictly convex, and therefore is a subspace $V_1$ of the vector space $V$. Note that $V_1$ does not include $\psi$ and it does not span the direction identified by $\rho_1$ and $\psi$. Furthermore, we can't have $\rho_1 = \rho$ as $\<\psi|\rho|\psi\>\neq 0$. Therefore we have that $\rho$ is an affine combination of $\psi$ and $\rho_1$, which must be a density operator of finite rank lower than $\rho$. We can express $\rho_1$ as a convex combination of finitely many extreme points $\psi_2, \psi_3, ..., \psi_n$, each of them corresponding to a pure state. We have that $\rho$ is an affine combination of pure states that include $\psi$.
\end{proof}

\begin{prop}\label{prop_superpositionIsDecomposition}[Superposition is multiple decomposition of mixed states.]
Let $\mathcal{H}$ be a complex vector space. Let $\psi \in \mathcal{H}$ be a normalized vector and $\{\phi_j\} \in \mathcal{H}$ a finte sets of normalized vectors that does not contain $\psi$. Then $\psi$ is a superposition of $\{\phi_j\}$ if and only if there exists a density operator $\rho$ that can be expressed both as a strict convex combination of $\{\phi_i\}$ and of another set of normalized vectors that contain $\psi$. That is, we can find a countable set of normalized vectors $\{\psi_i\} \in \mathcal{H}$ and two sequences $\{a_i\}, \{b_j\} \in \mathbb{R}^+$ such that
\begin{enumerate}
	\item $\psi_1 = \psi$
	\item $\sum_i a_i = 1$
	\item $\sum_j b_j = 1$
	\item $\sum_i a_i |\psi_i\>\<\psi_i| = \sum_j b_j |\phi_j\>\<\phi_j|$,
\end{enumerate}
\end{prop}

\begin{proof}
	Suppose $\psi$ is a normalized state that can be written as $\psi = \sum_{i=1}^n c_i \phi_i$ where $\{\phi_i\} \in \mathcal{H}$ a finte sets of normalized vectors that do not contain $\psi$. Since $\{\phi_j\}$ are not necessarily orthogonal, it is not necessarily true that $|\<\psi|\phi_i\>| = |c_i|^2 \neq 0$. However, since $\psi$ is normalized, there must be at least two vectors in $\{\phi_i\}$ such that $|\<\psi|\phi_i\>| \neq 0$. We can then find $\{p_i\} \in \mathbb{R}+$ for which $\sum_i p_i =1$, such that $\rho = \sum_i p_i |\phi_j\>\<\phi_j|$ and $\<\psi|\rho|\psi\> \neq 0$. By Proposition \ref{prop_decomposition}, $\rho$ can be expressed as a convex combination of a set of normalized states that include $\psi$.
	
	Conversely, suppose we have a density operator $\rho$ that can be expressed both as a strict convex combination of $\{\phi_i\}$ and of another set of normalized vectors that contain $\psi$. By Proposition \ref{prop_densitySpan} the span of $\{\phi_i\}$ will include $\psi$ and therefore $\psi$ is a superposition of $\{\phi_i\}$.
\end{proof}

We can now show that the inner product space structure is physical in the sense that it is exactly the structure that is needed to model quantum mixed states and their entropy. One key difference between classical and quantum mechanics is that there is no single decomposition of quantum mixed states in terms of pure states. We can show that relationships of superposition are equivalent to relationships of multiple decomposition.

\begin{proof}
	Let's first address the trivial case in which $\phi_1 = \phi_2$. Suppose that $\psi = c_1 \phi_1 + c_2 \phi_2$, then $\psi = \phi_1$. We set $\bar{\psi} = \psi$ and find $p_1|\psi\>\<\psi| + p_2|\bar{\psi}\>\<\bar{\psi}| = \frac{1}{2}|\phi_1\>\<\phi_1| + \frac{1}{2}|\phi_2\>\<\phi_2|$ for any $p_1, p_2 \in \mathbb{R}$ such that $p_1+p_2=1$. Conversely, suppose $p_1|\psi\>\<\psi| + p_2|\bar{\psi}\>\<\bar{\psi}| = \frac{1}{2}|\phi_1\>\<\phi_1| + \frac{1}{2}|\phi_2\>\<\phi_2|$ for some $p_1, p_2 \in \mathbb{R}$ such that $p_1+p_2=1$. Then $p_1|\psi\>\<\psi| + p_2|\bar{\psi}\>\<\bar{\psi}| = |\phi_1\>\<\phi_1|$ which can be true only if $\psi=\bar{\psi}=\phi_1$.
	
	Now let's address the case in which $\phi_1 \neq \phi_2$. Suppose that $\psi = c_1 \phi_1 + c_2 \phi_2$. Then $\psi$ is part of the subspace defined by $\phi_1$ and $\phi_2$, which means all the states can be represented as points on the surface of a Bloch sphere. The mixed state $\rho=\frac{1}{2}|\phi_1\>\<\phi_1| + \frac{1}{2}|\phi_2\>\<\phi_2|$ is the midpoint of the chord connecting $\phi_1$ and $\phi_2$. Now, take the line that connects $\rho$ with $\psi$. This line will traverse the sphere in another point $\hat{\psi}$. As $\rho$ sits on the chord between $\psi$ and $\bar{\psi}$, it is a mixture of the two states for some $p_1$ and $p_2$. Conversely, suppose $\rho = p_1|\psi\>\<\psi| + p_2|\bar{\psi}\>\<\bar{\psi}| = \frac{1}{2}|\phi_1\>\<\phi_1| + \frac{1}{2}|\phi_2\>\<\phi_2|$. This means that the subspace spanned by $\psi$ and $\bar{\psi}$ is the same as the one spanned by $\phi_1$ and $\phi_2$, which means that $\psi = c_1 \phi_1 + c_2 \phi_2$ for some $c_1, c_2 \in \mathbb{C}$ such that $|p_1|^2+|p_2|^2=1$.
\end{proof}

As for the inner product, we show that it can be fully characterized, instead of by the Born rule, but the entropy of equal mixtures over state pairs. This gives us a geometric understanding of the inner product at equal time, instead of a probability of transition.

\begin{prop}\label{prop_innerProductIsEntropy}[Inner product is an entropic structure]
Let $\mathcal{H}$ be a complex Hilbert space. Let $I : \mathcal{H} \times \mathcal{H} \to \mathbb{R}$ be the von Neumann entropy of the equal mixture of two pure states. That is
\begin{equation}
	I(\psi_1, \psi_2) = S\left(\frac{1}{2}|\psi_1\>\<\psi_1| + \frac{1}{2}|\psi_2\>\<\psi_2|\right).
\end{equation}
Let $p :  \mathcal{H} \times \mathcal{H} \to \mathbb{R}$ be the square of the inner product. That is
\begin{equation}
	p(\psi_1, \psi_2) = |\<\psi_1| \psi_2\>|^2.
\end{equation}
Then $p$ and $I$ can be reconstructed from other. That is, there exists an invertible function $f$ such that
\begin{equation}
	I(\psi_1, \psi_2) = f(p(\psi_1, \psi_2)).
\end{equation}
\end{prop}

\begin{proof}
	Copy proof from other paper.
\end{proof}

We are then able to argue for the following
\begin{prop}
	The description of quantum states as rays of a complex inner product space is physically justified.
\end{prop}
\begin{justification}
	Since physical preparations and measurements are most of the type not perfect, a physical theory must define statistical ensembles. Part of that definition includes keeping track statistical ensembles under statistical mixtures, that is which particular mixture is obtained by mixing particular states in particular proportions. A particular feature of quantum mixed states is that, unlike classical states, they do not in general provide a unique decomposition in terms of pure states. This non-unique decomposition, as shown by proposition \ref{prop_superpositionIsDecomposition}, is equivalent to the ability to create superpositions of pure state. The inner product structure is therefore the exact structure needed to characterize quantum ensembles and their properties, which is required by the physics.
	
	Additionally, a physical theory must be able to define the entropy of each ensemble, as required by thermodynamics. In quantum mechanics, the thermodynamic entropy is recovered by the von Neumann entropy, which Proposition \ref{prop_innerProductIsEntropy} show it is exactly captured by the inner product. This again shows that the inner product structure is required to capture a necessary physical requirement.
\end{justification}

\end{document}
